CLASS Cyberaugumented_StartupHandler : StaticEventHandler
{
	ui int timer;
	bool detected;
	
	override void OnRegister()
	{
		for ( int i=0; i<AllActorClasses.size(); i++ )
		{
			if ( AllActorClasses[i].GetClassName() == "BDoomer" || AllActorClasses[i].GetClassName() == "Doomer"
				|| AllActorClasses[i].GetClassName() == "BrutalDoomer" || AllActorClasses[i].GetClassName() == "HDoomPlayer"
				|| AllActorClasses[i].GetClassName() == "ComplexDoomPlayer")
				detected = true;
			
			if ( detected ) break;
		}
		
		if ( !detected )
			return;
		else
		{
			S_ChangeMusic("");
			Console.Printf("This mod cannot be loaded.");
			
			for (int i = 100; i > 90; i--)
				S_StartSound("CYBECREP", i, CHANF_UI|CHANF_NOPAUSE|CHANF_OVERLAP, 1.0, ATTN_NONE);
		}
	}
	
	override void WorldLoaded( WorldEvent e )
	{
		if ( !detected && !bDestroyed )
			Destroy();
	}
	
	override void WorldTick()
	{
		if ( !detected ) return;
		
		for (int i = 0; i < MAXPLAYERS; i++)
			if ( playeringame[i] ) players[i].cheats |= CF_TOTALLYFROZEN;
	}
	
	override void NewGame()
	{
		if ( !detected ) return;
	}
	
	override void UiTick()
	{
		if ( !detected ) return;
		S_ChangeMusic("");
		
		if (timer == 1)
		{
			for (int i = 1000; i > 0; i--)
				Console.Printf("\n");
			
			ThrowAbortException("This mod cannot be loaded.");
		}
		
		timer += 1;
	}
}